import{v as e}from"./vendor-BhfxMwoc.js";import{_ as a}from"./WalletTypeSelect.vue_vue_type_script_setup_true_lang-C1gKsLYj.js";import{_ as l}from"./ChainTypeSelect.vue_vue_type_style_index_0_lang-BnpxTwcj.js";import{_ as t}from"./CurrencySelect-BCxrVlg4.js";import{_ as n,d as i,a as c}from"./DateRangeSelect-BgOmWin7.js";import{_ as o,k as s,l as r}from"./index-Bm9Z6zrZ.js";import{b as d}from"./ant-design-0M0Sv-BJ.js";import{r as u,f as m,c as p,a0 as W,Z as f,k as T,Y as y,X as h,_ as v,u as B,G as L,a1 as w,a4 as x,W as A,F as b,$ as g}from"./vue-vendor-B-98Oggh.js";import"./lodash-CiXSdKEp.js";const E={walletBalanceList:[{id:"WB20240122001",date:"2024-01-22",merchant:"商戶A",walletId:"WALLET001",chainType:"BTC",currency:"BTC",balance:"12.45678900",reconciliationStatus:"success"},{id:"WB20240122002",date:"2024-01-22",merchant:"商戶B",walletId:"WALLET002",chainType:"ETH",currency:"ETH",balance:"156.78900000",reconciliationStatus:"failed"},{id:"WB20240122003",date:"2024-01-22",merchant:"商戶C",walletId:"WALLET003",chainType:"TRON",currency:"USDT",balance:"50000.00000000",reconciliationStatus:"success"},{id:"WB20240122004",date:"2024-01-22",merchant:"商戶A",walletId:"WALLET004",chainType:"EVM",currency:"USDC",balance:"75000.00000000",reconciliationStatus:"success"},{id:"WB20240122005",date:"2024-01-22",merchant:"商戶D",walletId:"WALLET005",chainType:"BTC",currency:"BTC",balance:"3.45678900",reconciliationStatus:"failed",manualProcessed:!0,manualDetails:{operator:"系統管理員",processTime:"2024-01-22 20:30:00",reason:"經檢查發現該筆對帳失敗是由於網路延遲導致的交易確認時間差，實際餘額正確，已進行人工確認處理。"}},{id:"WB20240122006",date:"2024-01-22",merchant:"商戶B",walletId:"WALLET006",chainType:"ETH",currency:"ETH",balance:"89.12345600",reconciliationStatus:"success"},{id:"WB20240122007",date:"2024-01-22",merchant:"商戶C",walletId:"WALLET007",chainType:"TRON",currency:"USDT",balance:"120000.00000000",reconciliationStatus:"success"},{id:"WB20240122008",date:"2024-01-22",merchant:"商戶D",walletId:"WALLET008",chainType:"EVM",currency:"USDC",balance:"95000.00000000",reconciliationStatus:"failed"},{id:"WB20240122009",date:"2024-01-22",merchant:"商戶A",walletId:"WALLET009",chainType:"BTC",currency:"BTC",balance:"5.67890000",reconciliationStatus:"success"},{id:"WB20240122010",date:"2024-01-22",merchant:"商戶B",walletId:"WALLET010",chainType:"ETH",currency:"ETH",balance:"234.56789000",reconciliationStatus:"success"}],reconciliationDetails:{WB20240122001:{openingBalance:"10.00000000",outAmount:"2.50000000",inAmount:"4.95678900",theoreticalBalance:"12.45678900",closingBalance:"12.45678900",difference:"0.00000000",transferOrders:[{id:"TR20240122001",fromWallet:"WALLET001",toWallet:"WALLET002",type:"fee",amount:"-0.00050000",txHash:"0x1234...5678",createTime:"2024-01-22 10:00:00"},{id:"TR20240122002",fromWallet:"WALLET003",toWallet:"WALLET001",type:"deposit",amount:"2.45678900",txHash:"0x2345...6789",createTime:"2024-01-22 11:30:00"},{id:"TR20240122003",fromWallet:"WALLET001",toWallet:"WALLET004",type:"withdrawal",amount:"-1.50000000",txHash:"0x3456...7890",createTime:"2024-01-22 14:20:00"},{id:"TR20240122004",fromWallet:"WALLET005",toWallet:"WALLET001",type:"collection",amount:"2.50000000",txHash:"0x4567...8901",createTime:"2024-01-22 15:45:00"},{id:"TR20240122005",fromWallet:"WALLET001",toWallet:"WALLET006",type:"pending",amount:"1.00000000",txHash:"0x5678...9012",createTime:"2024-01-22 16:30:00"},{id:"TR20240122006",fromWallet:"WALLET007",toWallet:"WALLET001",type:"manualDeposit",amount:"0.50000000",txHash:"-",createTime:"2024-01-22 17:15:00"},{id:"TR20240122007",fromWallet:"WALLET001",toWallet:"WALLET008",type:"manualWithdrawal",amount:"-1.00000000",txHash:"-",createTime:"2024-01-22 17:45:00"},{id:"TR20240122008",fromWallet:"WALLET009",toWallet:"WALLET001",type:"exchange",amount:"1.50000000",txHash:"0x8901...2345",createTime:"2024-01-22 18:20:00"},{id:"TR20240122009",fromWallet:"WALLET010",toWallet:"WALLET001",type:"supplement",amount:"0.50000000",txHash:"-",createTime:"2024-01-22 19:00:00"},{id:"TR20240122010",fromWallet:"WALLET001",toWallet:"WALLET011",type:"fee",amount:"-0.00050000",txHash:"0x9012...3456",createTime:"2024-01-22 19:30:00"}]},WB20240122002:{openingBalance:"150.00000000",outAmount:"5.00000000",inAmount:"11.78900000",theoreticalBalance:"156.78900000",closingBalance:"156.78800000",difference:"-0.00100000",transferOrders:[{id:"TR20240122011",fromWallet:"WALLET002",toWallet:"WALLET012",type:"withdrawal",amount:"-5.00000000",txHash:"0xabcd...ef12",createTime:"2024-01-22 12:00:00"},{id:"TR20240122012",fromWallet:"WALLET013",toWallet:"WALLET002",type:"deposit",amount:"11.78900000",txHash:"0xbcde...f123",createTime:"2024-01-22 13:30:00"}]},WB20240122005:{openingBalance:"2.00000000",outAmount:"1.00000000",inAmount:"2.45678900",theoreticalBalance:"3.45678900",closingBalance:"3.45678900",difference:"0.00000000",transferOrders:[{id:"TR20240122013",fromWallet:"WALLET005",toWallet:"WALLET014",type:"withdrawal",amount:"-1.00000000",txHash:"0xcdef...1234",createTime:"2024-01-22 09:30:00"},{id:"TR20240122014",fromWallet:"WALLET015",toWallet:"WALLET005",type:"deposit",amount:"2.45678900",txHash:"0xdef1...2345",createTime:"2024-01-22 11:00:00"}]},WB20240122008:{openingBalance:"90000.00000000",outAmount:"2000.00000000",inAmount:"7000.00000000",theoreticalBalance:"95000.00000000",closingBalance:"95000.15000000",difference:"0.15000000",transferOrders:[{id:"TR20240122015",fromWallet:"WALLET008",toWallet:"WALLET016",type:"withdrawal",amount:"-2000.00000000",txHash:"0xef12...3456",createTime:"2024-01-22 10:15:00"},{id:"TR20240122016",fromWallet:"WALLET017",toWallet:"WALLET008",type:"deposit",amount:"7000.00000000",txHash:"0xf123...4567",createTime:"2024-01-22 14:45:00"}]}}},k={class:"wallet-balance"},_={class:"card-title"},I={class:"form-row"},S={class:"form-row"},C={class:"form-item-sm button-group"},H={class:"card-title"},R={class:"table-container"},D={class:"reconciliation-info"},U={class:"info-row"},V={class:"info-item"},j={class:"label"},O={class:"value"},P={class:"info-item"},z={class:"label"},F={class:"value"},N={class:"info-item"},$={class:"label"},q={class:"value"},M={class:"info-row"},Q={class:"info-item"},G={class:"label"},J={class:"value"},X={class:"info-item"},Y={class:"label"},Z={class:"value"},K={class:"info-item"},ee={class:"label"},ae={class:"transfer-orders"},le={class:"section-title"},te={key:0,class:"hash-text"},ne={key:1},ie={key:0,class:"manual-details"},ce={class:"detail-item"},oe={class:"detail-label"},se={class:"detail-value"},re={class:"detail-item"},de={class:"detail-label"},ue={class:"detail-value"},me={class:"detail-item"},pe={class:"detail-label"},We={class:"detail-value reason-text"},fe=o({__name:"WalletBalance",setup(o){const fe={zh:{...r,...c},en:{...s,...i}},{t:Te}=e({messages:fe,legacy:!1}),ye=u({dateRange:[],walletId:"",walletAddress:"",walletType:void 0,chainType:void 0,currency:void 0}),he=[{title:Te("reconciliation.WalletBalance.table.date"),dataIndex:"date",key:"date",width:120},{title:Te("reconciliation.WalletBalance.table.merchant"),dataIndex:"merchant",key:"merchant",width:120},{title:Te("reconciliation.WalletBalance.table.walletId"),dataIndex:"walletId",key:"walletId",width:150},{title:Te("reconciliation.WalletBalance.table.chainType"),dataIndex:"chainType",key:"chainType",width:120},{title:Te("reconciliation.WalletBalance.table.currency"),dataIndex:"currency",key:"currency",width:120},{title:Te("reconciliation.WalletBalance.table.balance"),dataIndex:"balance",key:"balance",width:200,align:"right"},{title:Te("reconciliation.WalletBalance.table.reconciliationStatus"),dataIndex:"reconciliationStatus",key:"reconciliationStatus",width:120},{title:Te("reconciliation.WalletBalance.table.action"),key:"action",width:120,fixed:"right"}],ve=m(E.walletBalanceList),Be=m(!1),Le=u({current:1,pageSize:10,total:E.walletBalanceList.length,showSizeChanger:!0,showQuickJumper:!0}),we=m(!1),xe=m(null),Ae=m(!1),be=m(!1),ge=u({reason:""}),Ee=m(null),ke=m(!1),_e=m(null),Ie=[{title:Te("reconciliation.WalletBalance.details.transferId"),dataIndex:"id",key:"id",width:150},{title:Te("reconciliation.WalletBalance.details.fromWallet"),dataIndex:"fromWallet",key:"fromWallet",width:150},{title:Te("reconciliation.WalletBalance.details.toWallet"),dataIndex:"toWallet",key:"toWallet",width:150},{title:Te("reconciliation.WalletBalance.details.transferType"),dataIndex:"type",key:"type",width:120},{title:Te("reconciliation.WalletBalance.details.amount"),dataIndex:"amount",key:"amount",width:150,align:"right"},{title:Te("reconciliation.WalletBalance.details.txHash"),dataIndex:"txHash",key:"txHash",width:200},{title:Te("reconciliation.WalletBalance.details.createTime"),dataIndex:"createTime",key:"createTime",width:180}],Se=()=>{Be.value=!0,setTimeout((()=>{Be.value=!1}),500)},Ce=()=>{ye.dateRange=[],ye.walletId="",ye.walletAddress="",ye.walletType=void 0,ye.chainType=void 0,ye.currency=void 0,Se()},He=e=>{Le.current=e.current,Le.pageSize=e.pageSize,Se()},Re=e=>new Intl.NumberFormat("en-US",{minimumFractionDigits:8,maximumFractionDigits:8}).format(e),De=()=>{we.value=!1,xe.value=null},Ue=p((()=>!!xe.value&&0!==parseFloat(xe.value.difference))),Ve=async()=>{if(ge.reason.trim()){be.value=!0;try{await new Promise((e=>setTimeout(e,1e3)));const e=Ee.value;e.manualProcessed=!0,e.manualDetails={operator:"系統管理員",processTime:(new Date).toLocaleString(),reason:ge.reason},d.success(Te("reconciliation.WalletBalance.message.processSuccess")),Ae.value=!1}catch(e){d.error(Te("reconciliation.WalletBalance.message.processFailed"))}finally{be.value=!1}}else d.error(Te("reconciliation.WalletBalance.message.reasonRequired"))},je=()=>{Ae.value=!1,ge.reason=""},Oe=()=>{ke.value=!1,_e.value=null};return(e,i)=>{const c=h("a-form-item"),o=h("a-input"),s=h("a-button"),r=h("a-space"),d=h("a-form"),u=h("a-card"),m=h("a-tag"),p=h("a-table"),fe=h("a-modal"),Pe=h("a-textarea");return f(),W("div",k,[T(u,{bordered:!1,class:"filter-card"},{title:y((()=>[v("span",_,w(B(Te)("reconciliation.WalletBalance.title.walletBalanceQuery")),1)])),default:y((()=>[T(d,{model:ye,class:"query-form"},{default:y((()=>[v("div",I,[T(c,{label:B(Te)("field.dateRange"),class:"form-item-lg"},{default:y((()=>[T(n,{modelValue:ye.dateRange,"onUpdate:modelValue":i[0]||(i[0]=e=>ye.dateRange=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1},8,["label"]),T(c,{label:B(Te)("reconciliation.WalletBalance.form.walletId"),class:"form-item-md"},{default:y((()=>[T(o,{value:ye.walletId,"onUpdate:value":i[1]||(i[1]=e=>ye.walletId=e),placeholder:B(Te)("reconciliation.WalletBalance.form.pleaseEnterWalletId"),style:{width:"100%"},"allow-clear":""},null,8,["value","placeholder"])])),_:1},8,["label"]),T(c,{label:B(Te)("reconciliation.WalletBalance.form.walletAddress"),class:"form-item-lg"},{default:y((()=>[T(o,{value:ye.walletAddress,"onUpdate:value":i[2]||(i[2]=e=>ye.walletAddress=e),placeholder:B(Te)("reconciliation.WalletBalance.form.pleaseEnterWalletAddress"),style:{width:"100%"},"allow-clear":""},null,8,["value","placeholder"])])),_:1},8,["label"])]),v("div",S,[T(c,{label:B(Te)("reconciliation.WalletBalance.form.walletType"),class:"form-item-md"},{default:y((()=>[T(a,{modelValue:ye.walletType,"onUpdate:modelValue":i[3]||(i[3]=e=>ye.walletType=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1},8,["label"]),T(c,{label:B(Te)("reconciliation.WalletBalance.form.chainType"),class:"form-item-md"},{default:y((()=>[T(l,{modelValue:ye.chainType,"onUpdate:modelValue":i[4]||(i[4]=e=>ye.chainType=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1},8,["label"]),T(c,{label:B(Te)("reconciliation.WalletBalance.form.currency"),class:"form-item-md"},{default:y((()=>[T(t,{modelValue:ye.currency,"onUpdate:modelValue":i[5]||(i[5]=e=>ye.currency=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1},8,["label"]),v("div",C,[T(r,null,{default:y((()=>[T(s,{onClick:Ce},{default:y((()=>[L(w(B(Te)("reconciliation.WalletBalance.common.reset")),1)])),_:1}),T(s,{type:"primary",onClick:Se},{default:y((()=>[L(w(B(Te)("reconciliation.WalletBalance.common.search")),1)])),_:1})])),_:1})])])])),_:1},8,["model"])])),_:1}),T(u,{bordered:!1,bodyStyle:{padding:"20px 24px"},class:"table-card"},{title:y((()=>[v("span",H,w(B(Te)("reconciliation.WalletBalance.title.reconciliationDetails")),1)])),default:y((()=>[v("div",R,[T(p,{columns:he,"data-source":ve.value,loading:Be.value,pagination:Le,onChange:He,"row-key":"id"},{bodyCell:y((({column:e,record:a})=>["balance"===e.key?(f(),W(b,{key:0},[L(w(Re(a.balance)),1)],64)):x("",!0),"reconciliationStatus"===e.key?(f(),A(m,{key:1,color:"success"===a.reconciliationStatus?"success":"error"},{default:y((()=>[L(w(B(Te)(`reconciliation.WalletBalance.status.${a.reconciliationStatus}`)),1)])),_:2},1032,["color"])):x("",!0),"action"===e.key?(f(),A(r,{key:2},{default:y((()=>[T(s,{type:"link",onClick:e=>(e=>{xe.value=E.reconciliationDetails[e.id],we.value=!0})(a)},{default:y((()=>[L(w(B(Te)("reconciliation.WalletBalance.action.viewDetails")),1)])),_:2},1032,["onClick"]),"failed"===a.reconciliationStatus?(f(),A(s,{key:0,type:"link",onClick:e=>(e=>{Ee.value=e,ge.reason="",Ae.value=!0})(a)},{default:y((()=>[L(w(B(Te)("reconciliation.WalletBalance.action.manualProcess")),1)])),_:2},1032,["onClick"])):x("",!0),a.manualProcessed?(f(),A(s,{key:1,type:"link",onClick:e=>(e=>{_e.value=e.manualDetails,ke.value=!0})(a)},{default:y((()=>[L(w(B(Te)("reconciliation.WalletBalance.action.manualProcessDetails")),1)])),_:2},1032,["onClick"])):x("",!0)])),_:2},1024)):x("",!0)])),_:1},8,["data-source","loading","pagination"])])])),_:1}),T(fe,{open:we.value,"onUpdate:open":i[6]||(i[6]=e=>we.value=e),title:B(Te)("reconciliation.WalletBalance.title.reconciliationDetails"),width:1200,onCancel:De},{footer:y((()=>[T(s,{onClick:De},{default:y((()=>[L(w(B(Te)("reconciliation.WalletBalance.common.close")),1)])),_:1})])),default:y((()=>{var e,a,l,t,n,i,c;return[v("div",D,[v("div",U,[v("div",V,[v("span",j,w(B(Te)("reconciliation.WalletBalance.details.openingBalance"))+":",1),v("span",O,w(Re(null==(e=xe.value)?void 0:e.openingBalance)),1)]),v("div",P,[v("span",z,w(B(Te)("reconciliation.WalletBalance.details.outAmount"))+":",1),v("span",F,w(Re(null==(a=xe.value)?void 0:a.outAmount)),1)]),v("div",N,[v("span",$,w(B(Te)("reconciliation.WalletBalance.details.inAmount"))+":",1),v("span",q,w(Re(null==(l=xe.value)?void 0:l.inAmount)),1)])]),v("div",M,[v("div",Q,[v("span",G,w(B(Te)("reconciliation.WalletBalance.details.theoreticalBalance"))+":",1),v("span",J,w(Re(null==(t=xe.value)?void 0:t.theoreticalBalance)),1)]),v("div",X,[v("span",Y,w(B(Te)("reconciliation.WalletBalance.details.closingBalance"))+":",1),v("span",Z,w(Re(null==(n=xe.value)?void 0:n.closingBalance)),1)]),v("div",K,[v("span",ee,w(B(Te)("reconciliation.WalletBalance.details.difference"))+":",1),v("span",{class:g(["value",{"error-text":Ue.value}])},w(Re(null==(i=xe.value)?void 0:i.difference)),3)])])]),v("div",ae,[v("div",le,w(B(Te)("reconciliation.WalletBalance.title.transferOrders")),1),T(p,{columns:Ie,"data-source":null==(c=xe.value)?void 0:c.transferOrders,pagination:{pageSize:5},size:"small"},{bodyCell:y((({column:e,record:a})=>{return["type"===e.key?(f(),W(b,{key:0},[L(w(B(Te)(`reconciliation.WalletBalance.transferType.${a.type}`)),1)],64)):x("",!0),"amount"===e.key?(f(),W("span",{key:1,class:g({"negative-amount":(l=a.amount,parseFloat(l)<0)})},w(Re(a.amount)),3)):x("",!0),"txHash"===e.key?(f(),W(b,{key:2},["-"!==a.txHash?(f(),W("span",te,w(a.txHash),1)):(f(),W("span",ne,"-"))],64)):x("",!0)];var l})),_:1},8,["data-source"])])]})),_:1},8,["open","title"]),T(fe,{open:Ae.value,"onUpdate:open":i[8]||(i[8]=e=>Ae.value=e),title:B(Te)("reconciliation.WalletBalance.title.manualProcess"),width:600,onOk:Ve,onCancel:je,confirmLoading:be.value},{default:y((()=>[T(d,{model:ge,"label-col":{span:6},"wrapper-col":{span:18}},{default:y((()=>[T(c,{label:B(Te)("reconciliation.WalletBalance.form.processReason")},{default:y((()=>[T(Pe,{value:ge.reason,"onUpdate:value":i[7]||(i[7]=e=>ge.reason=e),rows:6,maxlength:500,placeholder:B(Te)("reconciliation.WalletBalance.form.pleaseEnterProcessReason"),"show-count":""},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])),_:1},8,["open","title","confirmLoading"]),T(fe,{open:ke.value,"onUpdate:open":i[9]||(i[9]=e=>ke.value=e),title:B(Te)("reconciliation.WalletBalance.title.manualProcessDetails"),width:600,onCancel:Oe,footer:null},{default:y((()=>[_e.value?(f(),W("div",ie,[v("div",ce,[v("span",oe,w(B(Te)("reconciliation.WalletBalance.details.operator"))+":",1),v("span",se,w(_e.value.operator),1)]),v("div",re,[v("span",de,w(B(Te)("reconciliation.WalletBalance.details.processTime"))+":",1),v("span",ue,w(_e.value.processTime),1)]),v("div",me,[v("span",pe,w(B(Te)("reconciliation.WalletBalance.details.processReason"))+":",1),v("div",We,w(_e.value.reason),1)])])):x("",!0)])),_:1},8,["open","title"])])}}},[["__scopeId","data-v-6f75109e"]]);export{fe as default};
